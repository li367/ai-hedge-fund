# AI对冲基金 - 系统架构文档

## 1. 系统概述

AI对冲基金是一个结合大型语言模型(LLM)与传统金融分析的交易系统，旨在利用人工智能技术进行市场分析并执行交易策略。系统主要面向加密货币市场，支持多种交易所和投资策略。

## 2. 核心组件

### 2.1 交易所集成 (`src/crypto/exchanges/`)

- **基础交易所接口** (`base.py`): 定义了所有交易所实现必须遵循的通用接口
- **OKX交易所** (`okx.py`): OKX交易所的API集成，支持现货和合约交易
- **Binance交易所**: Binance交易所的API集成

每个交易所实现支持以下功能：
- 账户余额查询
- 市场数据获取(K线、深度、订单簿等)
- 订单管理(下单、撤单、查询)
- 持仓管理
- 杠杆设置(适用于合约交易)

### 2.2 交易策略 (`src/crypto/strategies/`)

- **LLM策略** (`llm_strategy.py`): 使用大型语言模型分析市场并生成交易信号
- **技术分析策略**: 基于传统技术指标的交易策略

LLM策略的工作流程：
1. 收集市场数据(价格、成交量、K线)
2. 获取市场新闻和事件
3. 通过LLM分析数据并生成市场观点
4. 根据风险参数和市场观点生成交易决策
5. 执行交易并监控结果

### 2.3 投资代理 (`src/agents/`)

系统模拟了多位知名投资者的投资哲学和策略：

- **Warren Buffett** (`warren_buffett.py`): 注重内在价值和护城河的价值投资策略
- **Charlie Munger** (`charlie_munger.py`): 多学科思维模型和长期投资理念
- **Benjamin Graham** (`ben_graham.py`): 注重安全边际的价值投资创始人策略
- **Bill Ackman** (`bill_ackman.py`): 激进型股东价值投资策略
- **Cathie Wood** (`cathie_wood.py`): 关注创新和颠覆性技术的成长投资策略

每个代理都基于LLM实现，通过提示工程引导模型按照特定投资者的思维方式分析市场。

### 2.4 LLM集成 (`src/llm/`)

系统集成了多个LLM提供商：
- OpenAI (GPT-4, GPT-3.5)
- Anthropic (Claude系列)
- 通义千问
- Groq (可选)

提供统一的接口来处理：
- 模型选择和配置
- API调用和错误处理
- 提示工程和模板管理
- 输出解析和结构化

### 2.5 回测系统 (`src/backtester.py`)

- 历史数据回测
- 性能评估(收益率、夏普比率、最大回撤等)
- 策略对比
- 参数优化
- 可视化结果展示

### 2.6 风险管理 (`src/crypto/risk_manager.py` & `src/agents/risk_manager.py`)

- 仓位规模控制
- 止损策略实现
- 风险暴露监控
- 资金分配优化
- 波动性管理

## 3. 辅助组件

### 3.1 数据处理 (`src/data/`)

- 市场数据获取和预处理
- 数据标准化和清洗
- 特征工程
- 数据存储和缓存

### 3.2 工具和API (`src/tools/`)

- 新闻和情感分析API
- 财务数据API
- 市场数据API
- 实用工具函数

### 3.3 可视化与图表 (`src/graph/`)

- 交易结果可视化
- 性能指标图表
- 市场数据可视化
- 代理决策流程可视化

## 4. 系统工作流程

1. **初始化**: 加载配置、连接交易所、初始化模型
2. **数据收集**: 获取市场数据、新闻和事件
3. **市场分析**: 
   - 技术分析 (指标计算)
   - 基本面分析 (财务数据)
   - 情感分析 (新闻和社交媒体)
   - LLM综合分析
4. **策略生成**: 根据分析结果生成交易信号
5. **风险评估**: 评估交易风险并调整仓位大小
6. **交易执行**: 在交易所执行订单
7. **监控与调整**: 持续监控市场和持仓，必要时调整策略

## 5. 扩展与定制

系统设计为模块化架构，便于扩展和定制：
- 添加新交易所集成
- 实现新交易策略
- 添加新代理模型
- 集成新的数据源
- 优化风险管理策略

## 6. 部署注意事项

- API密钥安全管理
- 错误处理和恢复机制
- 日志记录和监控
- 性能优化
- 定期备份